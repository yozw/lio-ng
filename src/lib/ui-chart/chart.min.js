var module=angular.module("ui.chart",[]);module.directive("uiChart",function(uiChartRefreshService,$timeout){return{restrict:"EACM",template:"<div></div>",replace:true,link:function(scope,elem,attrs){var needsRefresh=false;function renderChart(){needsRefresh=false;var data=scope.$eval(attrs.uiChart);elem.html("");if(!angular.isArray(data)){return}var opts={};if(!angular.isUndefined(attrs.chartOptions)){opts=scope.$eval(attrs.chartOptions);if(!angular.isObject(opts)){throw"Invalid ui.chart options attribute"}}elem.jqplot(data,opts)}function scheduleRefresh(){needsRefresh=true;$timeout(function(){if(needsRefresh){renderChart()}},50)}scope.$watch(attrs.uiChart,function(){scheduleRefresh()},true);scope.$watch(attrs.chartOptions,function(){scheduleRefresh()});scope.uiChartRefreshService=uiChartRefreshService;scope.$watch("uiChartRefreshService",function(){scheduleRefresh()},true)}}});module.service("uiChartRefreshService",function(){return{refreshAll:function(message){this.token.value++},token:{value:0}}});