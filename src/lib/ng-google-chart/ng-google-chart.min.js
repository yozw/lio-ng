(function(a,c,b){b.module("googlechart",[]).factory("FormatManager",function(){function d(){var g=this;var k={};g.iFormats={};g.applyFormats=h;function f(o,n){var l,m;for(m in o){if(o.hasOwnProperty(m)){for(l=0;l<g.iFormats[m].length;l++){if(o[m][l].columnNum<n.getNumberOfColumns()){g.iFormats[m][l].format(n,o[m][l].columnNum)}}}}}function j(n,m,o){var l;if(b.isArray(o[n])){if(!b.equals(o[n],k[n])){k[n]=o[n];g.iFormats[n]=[];if(n==="color"){i(o)}else{for(l=0;l<o[n].length;l++){g.iFormats[n].push(new m(o[n][l]))}}}}}function h(n,o,q){var m,l,p=false;if(!b.isDefined(o)||!b.isDefined(n)){return}for(m in o){if(o.hasOwnProperty(m)){l=e(m,q);if(!b.isFunction(l)){continue}j(m,l,o);if(m==="arrow"||m==="bar"||m==="color"){p=true}}}f(o,n);return{requiresHtml:p}}function i(q){var m,n,l,p,o="color";for(m=0;m<q[o].length;m++){n=new google.visualization.ColorFormat();for(l=0;l<q[o][m].formats.length;l++){p=q[o][m].formats[l];if(typeof(p.fromBgColor)!=="undefined"&&typeof(p.toBgColor)!=="undefined"){n.addGradientRange(p.from,p.to,p.color,p.fromBgColor,p.toBgColor)}else{n.addRange(p.from,p.to,p.color,p.bgcolor)}}g.iFormats[o].push(n)}}function e(m,n){var l=m.charAt(0).toUpperCase()+m.slice(1).toLowerCase()+"Format";if(google.visualization.hasOwnProperty(l)){return google.visualization[l]}else{if(b.isDefined(n)&&n.hasOwnProperty(m)){return n[m]}}return}}return d}).value("googleChartApiConfig",{version:"1",optionalSettings:{packages:["corechart"]}}).provider("googleJsapiUrl",function(){var e="https:";var d="//www.google.com/jsapi";this.setProtocol=function(f){e=f};this.setUrl=function(f){d=f};this.$get=function(){return(e?e:"")+d}}).factory("googleChartApiPromise",["$rootScope","$q","googleChartApiConfig","googleJsapiUrl",function(d,h,g,k){var e=h.defer();var j=function(){var l={callback:function(){var m=g.optionalSettings.callback;d.$apply(function(){e.resolve()});if(b.isFunction(m)){m.call(this)}}};l=b.extend({},g.optionalSettings,l);c.google.load("visualization",g.version,l)};var i=a.getElementsByTagName("head")[0];var f=a.createElement("script");f.setAttribute("type","text/javascript");f.src=k;if(f.addEventListener){f.addEventListener("load",j,false)}else{f.onreadystatechange=function(){if(f.readyState==="loaded"||f.readyState==="complete"){f.onreadystatechange=null;j()}}}i.appendChild(f);return e.promise}]).directive("googleChart",["$timeout","$window","$rootScope","googleChartApiPromise",function(f,h,d,g){e.$inject=["$scope","$element","$attrs","$injector","FormatManager"];function e(A,w,k,C,y){var v=this;var F,D={},l,p={},x=null;v.registerChartListener=n;v.registerWrapperListener=z;E();function r(){F()}function s(){if(!s.triggered&&(v.chart!==undefined)){s.triggered=true;f(t,0,true)}else{if(v.chart!==undefined){f.cancel(s.recallTimeout);s.recallTimeout=f(s,10)}}}function o(){g.then(function(){s()})}function u(){A.$eval(k.beforeDraw,{chartWrapper:A.chartWrapper});v.chartWrapper.draw();s.triggered=false}q.$inject=["args"];function q(I){var H=I[0];console.log("Chart not displayed due to error: '"+H.message+"' Full error object follows.");console.log(H)}function j(){v.chart.displayed=true;if(x!==v.chartWrapper.getChart()){x=v.chartWrapper.getChart();B(x,p)}}function E(){A.$watch(i,m,true);F=d.$on("resizeMsg",function(){f(function(){if(v.chartWrapper){o()}})});A.$on("$destroy",r());z("error",q,v);z("ready",j,v)}function t(){if(typeof(v.chartWrapper)==="undefined"){var H={chartType:v.chart.type,dataTable:v.chart.data,view:v.chart.view,options:v.chart.options,containerId:w[0]};v.chartWrapper=new google.visualization.ChartWrapper(H);B(v.chartWrapper,D)}else{v.chartWrapper.setChartType(v.chart.type);v.chartWrapper.setDataTable(v.chart.data);v.chartWrapper.setView(v.chart.view);v.chartWrapper.setOptions(v.chart.options)}if(!l){l=new y()}var I=l.applyFormats(v.chartWrapper.getDataTable(),v.chart.formatters,v.chart.customFormatters);if(I&&I.requiresHtml){v.chartWrapper.setOption("allowHtml",true)}f(u)}function m(){v.chart=A.$eval(k.chart);o()}function i(){var H=A.$eval(k.chart);if(b.isDefined(H)&&b.isObject(H)){return{customFormatters:H.customFormatters,data:H.data,formatters:H.formatters,options:H.options,type:H.type,view:H.view}}}function G(K,J,H,L){var I=function(){var M={chartWrapper:v.chartWrapper,chart:v.chartWrapper.getChart(),args:arguments};C.invoke(H,L||this,M)};if(b.isDefined(K)&&b.isObject(K)){if(!b.isArray(K[J])){K[J]=[]}K[J].push(I);return function(){if(b.isDefined(I.googleListenerHandle)){google.visualization.events.removeListener(I.googleListenerHandle)}var M=K[J].indexOf(I);K[J].splice(M,1);if(K[J].length===0){K[J]=undefined}}}}function B(K,J){for(var H in J){if(J.hasOwnProperty(H)&&b.isArray(J[H])){for(var I=0;I<J[H].length;I++){if(b.isFunction(J[H][I])){J[H][I].googleListenerHandle=google.visualization.events.addListener(K,H,J[H][I])}}}}}function n(I,H,J){return G(p,I,H,J)}function z(I,H,J){return G(D,I,H,J)}}return{restrict:"A",scope:false,controller:e}}]).directive("onReady",function(){return{restrict:"A",scope:false,require:"googleChart",link:function(g,f,e,d){h.$inject=["chartWrapper"];function h(i){g.$apply(function(){g.$eval(e.onReady,{chartWrapper:i})})}d.registerWrapperListener("ready",h,this)}}}).directive("onSelect",function(){return{restrict:"A",scope:false,require:"googleChart",link:function(g,f,e,d){h.$inject=["chartWrapper","chart"];function h(j,k){var i={selectedItems:k.getSelection()};i.selectedItem=i.selectedItems[0];i.chartWrapper=j;i.chart=k;g.$apply(function(){g.$eval(e.onSelect,i)})}d.registerWrapperListener("select",h,this)}}}).directive("onError",function(){return{restrict:"A",scope:false,require:"googleChart",link:function(g,f,e,d){h.$inject=["chartWrapper","chart","args"];function h(k,l,j){var i={chartWrapper:k,chart:l,args:j,error:j[0],err:j[0],id:j[0].id,message:j[0].message};g.$apply(function(){g.$eval(e.onError,i)})}d.registerWrapperListener("error",h,this)}}}).run(["$rootScope","$window",function(d,e){b.element(e).bind("resize",function(){d.$emit("resizeMsg")})}])})(document,window,window.angular);